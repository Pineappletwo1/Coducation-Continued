export default function ErrorMessagesExtractor(messages, htmlTemplates, whenNotFoundMessage) {

    function extractErrorDetail(xhr) {
        if (xhr && xhr.responseText != '') {
            return $.parseJSON(xhr.responseText);
        }
        return {};
    }

    function extractMessageFor(errorType, errorDetail) {
        let message = messages[errorType];
        if (!message) return whenNotFoundMessage();
        return message(extractErrorDetail(errorDetail));
    }

    function extractHtmlFor(errorType, errorDetail) {
        let template = htmlTemplates[errorType];
        if (!template) return null;
        return template(extractErrorDetail(errorDetail));
    }

    return {
        extractMessageFor,
        extractHtmlFor
    };
}