import Combination from './combination';

export default function CombinationsBuilder(dialogPublisher, translator) {
    
    function buildFor(itemCode, combinations, catalog) {
        let rootOfCombinationEquipment = catalog.findItem(itemCode);
        return _.map(combinations, (combination) => buildCombinationFor(rootOfCombinationEquipment, combination, catalog));
    }

    function buildCombinationFor(rootItem, combination, catalog) {
        let combinationCodes = _.map(combination, (item) => item.code);
        let catalogItems = catalog.findItems(combinationCodes);
        return Combination(rootItem, catalogItems, dialogPublisher, translator);
    }

    return {
        buildFor,
        buildCombinationFor
    };
}